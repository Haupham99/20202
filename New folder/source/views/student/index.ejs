<% extend("./../main/main") %>
<link href="css/personal.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/pvhau/personal.js"></script>
<script type="text/javascript" src="js/pvhau/personalGeneral.js"></script>

<div class="hbg"><img src="images/header_images.jpg" width="923" height="291" alt="" /></div>
<div class="tb">
   <div class="sidebar">
      <div class="gadget">
         <h2 class="star"><span></span> Menu</h2>
         <div class="clr"></div>
         <ul class="sb_menu">
            <li class="tab-home"><a href="./">Trang chủ</a></li>
            <li class="tab-group-class"><a href="./group-class">Nhóm lớp</a></li>
            <li class="tab-chat"><a href="./chat">Nói chuyện</a></li>
            <li class="tab-notification"><a href="./notification">Thống báo</a></li>
            <li class="tab-profile"><a href="./personal">Trang cá nhân</a></li>
         </ul>
      </div>
      <div class="gadget">
         <h2 class="star"><span>Thông tin nổi bật</span></h2>
         <div class="clr"></div>
         <ul class="ex_menu">
            <li><a href="#">Tuyển sinh năm 2021</a></li>
            <li><a href="#">Điểm rèn luyện kỳ học 20201</a></li>
         </ul>
      </div>
   </div>
   <div class="clr"></div>
   <div class="td" id="m-col">
      <div>
         <button class="btn btn-alert"><h1>Bảng tin</h1></button>
         <% if(postArr != undefined) { %>
         <% postArr.forEach((item) => { %>
            <p style="display: none;"><%= item.id %></p>
            <div>
               <a class="a-notif-post" href="#<%= item.id %>" id="<%= item.id %>" name="<%= item.id %>"></a>
               <div class="post">
                  <div class="tb">
                     <a href="/<%= item.email %>" class="td p-p-pic"><img src="images/<%= user.avatar %>" alt="images/<%= user.avatar %>"></a>
                     <div class="td p-r-hdr">
                        <div class="p-u-info">
                           <a href="/<%= item.email %>"><%= item.username %></a> 
                        </div>
                        <div class="p-dt">
                           <i class="material-icons">calendar_today</i>
                           <span>
                           <% if (Math.ceil((Date.now() - item.createdAt)/3600000) > 24) {%>
                           <%- Math.ceil((Date.now() - item.createdAt)/3600000/24) %> days ago 
                           <% } else if (Math.ceil((Date.now() - item.createdAt)/3600000) == 1){ %>
                           Vừa xong
                           <% } else { %>
                           <%- Math.ceil((Date.now() - item.createdAt)/3600000) %> h ago %>
                           <% } %>
                           </span>
                        </div>
                     </div>
                     <div class="td p-opt"><i class="material-icons">keyboard_arrow_down</i></div>
                  </div>
                  <div style="margin-top: 20px;">
                     <%= item.description %></p>
                     <div class="tb" style="margin-bottom: 20px;">
                        <div class="tr">
                           <div class="td">
                              <% if(item.image1 != '') { %>
                              <img src="images/<%= item.image1 %>" class="display-img"/>
                              <% } %>
                           </div>
                           <div class="td">
                              <% if(item.image2 != '') { %>
                              <img src="images/<%= item.image2 %>" class="display-img"/>
                              <% } %>
                           </div>
                        </div>
                        <div class="tr">
                           <div class="td">
                              <% if(item.image3 != '') { %>
                              <img src="images/<%= item.image3 %>" class="display-img"/>
                              <% } %>
                           </div>
                           <div class="td">
                              <% if(item.image4 != '') { %>
                              <img src="images/<%= item.image4 %>" class="display-img"/>
                              <% } %>
                           </div>
                        </div>
                     </div>
                     <div>
                        <div class="p-acts">
                           <div class="p-act like">
                              <i class="fas fa-thumbs-up"></i><span><%= item.likes  %></span>
                              <p style="display: none;"><%= item._id %></p>
                              <h1 style="display: none;"><%= item.userId %></h1>
                           </div>
                           <div class="p-act comment"><i class="material-icons">comment</i><span><%= item.comments  %></span></div>
                           <div class="p-act share"><i class="material-icons">reply</i></div>
                        </div>
                     </div>
                  </div>
               </div>
               <hr class="solid">
               <p class="all-comment">Xem tất cả bình luận</p>
               <div class="comment-wrapper">
                  <ul class="media-list">
                     <% if(item.commentList != undefined) { %>
                     <% item.commentList.forEach((comment, index) => { %>
                     <% let lengthCommentList = item.commentList.length %>
                     <li class="media" style="position: relative;">
                        <div class="dropdown dropleft" style="position:absolute; right: 20px; cursor: pointer;">
                           <h5 data-toggle="dropdown">...
                           <span class="caret"></span></h5>
                           <ul class="dropdown-menu">
                             <li><a href="#">Xóa bình luận</a></li>
                           </ul>
                         </div>
                        <p class="comment-index comment-index-<%=index%>"><%=lengthCommentList-index%></p>
                        <a href="/<%= comment.email.split('@')[0] %>" class="pull-left">
                        <img class="rounded-circle" src="images/<%= comment.avatar %>" width="40">
                        </a>
                        <div class="media-body">
                           <span class="text-muted pull-right">
                           <small class="text-muted">
                              <% if (Math.ceil((Date.now() - comment.createdAt)/3600000) > 24) {%>
                              <%- Math.ceil((Date.now() - comment.createdAt)/3600000/24) %> days ago 
                              <% } else if (Math.ceil((Date.now() - comment.createdAt)/3600000) == 1){ %>
                              Vừa xong
                              <% } else { %>
                              <%- Math.ceil((Date.now() - comment.createdAt)/3600000) %> h ago %>
                              <% } %>
                           </small>
                           </span>
                           <strong class="text-success"><%= comment.username %></strong>
                           <p>
                              <%= comment.comment %>
                           </p>
                        </div>
                     </li>
                     <% }); %>
                     <% } %>
                  </ul>
               </div>
               <div class="bg-light p-2">
                  <div class="d-flex flex-row align-items-start">
                     <img class="rounded-circle" src="images/<%= user.avatar %>" width="40">
                     <textarea class="form-control ml-1 shadow-none textarea textarea-comment"></textarea>
                  </div>
                  <div class="text-right" style="margin-top: 10px;">
                     <p class="comment-id" style="display: none;"><%= item.id %></p>
                     <button class="btn btn-success post-comment">Đăng</button>
                     <button class="btn btn-danger cancel-comment">Hủy</button>
                  </div>
               </div>
               <hr>
            </div>
         <% }); %>
         <% } %>
         <div id="loading"><i class="material-icons">autorenew</i></div>
      </div>
   </div>
</div>


